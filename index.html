<!DOCTYPE html>
<html lang=en>
<head>
  <title>Chatbot Demo Page</title>
  <style>
    body {
     background: url(hand-2692450_1920.jpg);
      background-repeat: no-repeat;
      background-size: cover;
    }
  </style>
  <meta name="viewport" content="width-device-width, initial-scale=1">
</head>
<body>
<script src="https://www.gstatic.com/dialogflow-console/fast/messenger/bootstrap.js?v=1"></script>
<df-messenger
  intent="WELCOME"
  chat-title="Housing Reasonable Accomodation Chatbot"
  agent-id="e9b92b63-a89f-4458-bb09-04bf7ba6c663"
  language-code="en"
></df-messenger>
<script>
  const dfMessenger = document.querySelector('df-messenger');
  dfMessenger.addEventListener('df-chip-clicked', function(event) {
    // Which Docassemble interview gets loaded into the iframe is based on small variations in the text on the dialogflow chip.
    if (event.detail.query == "Finish My Form!") {
        //animals
        document.querySelectorAll('iframe').forEach(e => e.remove());
        var iframe = document.createElement('iframe');
        iframe.style.width = "100vw";
        iframe.style.height = "1200px";
        iframe.src = "https://idaholegalaid.documate.org/interview?i=docassemble.IdahoRAForms:data/questions/animal.yml&reset=1";
        document.body.appendChild(iframe);
        document.querySelector("body > df-messenger").shadowRoot.querySelector("#widgetIcon").click();
    }
    if (event.detail.query == "Complete My Form!") {
        //mail
        document.querySelectorAll('iframe').forEach(e => e.remove());
        var iframe = document.createElement('iframe');
        iframe.style.width = "100vw";
        iframe.style.height = "1200px";
        iframe.src = "https://docassemble.metatheria.solutions/interview?i=docassemble.playground1IdahoRAForms%3Amail.yml&reset=1";
        document.body.appendChild(iframe);
        document.querySelector("body > df-messenger").shadowRoot.querySelector("#widgetIcon").click();
    }
    if (event.detail.query == "Finish the Form!") {
        //parking
        document.querySelectorAll('iframe').forEach(e => e.remove());
        var iframe = document.createElement('iframe');
        iframe.style.width = "100vw";
        iframe.style.height = "1200px";
        iframe.src = "https://docassemble.metatheria.solutions/interview?i=docassemble.playground1IdahoRAForms%3Aparking.yml&reset=1";
        document.body.appendChild(iframe);
        document.querySelector("body > df-messenger").shadowRoot.querySelector("#widgetIcon").click();
    }
    if (event.detail.query == "Complete the Form!") {
        //stairs
        document.querySelectorAll('iframe').forEach(e => e.remove());
        var iframe = document.createElement('iframe');
        iframe.style.width = "100vw";
        iframe.style.height = "1200px";
        iframe.src = "https://docassemble.metatheria.solutions/interview?i=docassemble.playground1IdahoRAForms%3Astairs.yml&reset=1";
        document.body.appendChild(iframe);
        document.querySelector("body > df-messenger").shadowRoot.querySelector("#widgetIcon").click();
    }
    if (event.detail.query == "Finish My Documents!") {
        // moveout time
        document.querySelectorAll('iframe').forEach(e => e.remove());
        var iframe = document.createElement('iframe');
        iframe.style.width = "100vw";
        iframe.style.height = "1200px";
        iframe.src = "https://docassemble.metatheria.solutions/interview?i=docassemble.playground1IdahoRAForms%3Amoveouttime.yml&reset=1";
        document.body.appendChild(iframe);
        document.querySelector("body > df-messenger").shadowRoot.querySelector("#widgetIcon").click();
    }
    if (event.detail.query == "Complete My Documents!") {
        // lease violation
        document.querySelectorAll('iframe').forEach(e => e.remove());
        var iframe = document.createElement('iframe');
        iframe.style.width = "100vw";
        iframe.style.height = "1200px";
        iframe.src = "https://docassemble.metatheria.solutions/interview?i=docassemble.playground1IdahoRAForms%3Aleaseviolation.yml&reset=1";
        document.body.appendChild(iframe);
        document.querySelector("body > df-messenger").shadowRoot.querySelector("#widgetIcon").click();
    }
    if (event.detail.query == "Finish The Documents!") {
        //shutoffs and housing conditions
        document.querySelectorAll('iframe').forEach(e => e.remove());
        var iframe = document.createElement('iframe');
        iframe.style.width = "100vw";
        iframe.style.height = "1200px";
        iframe.src = "https://docassemble.metatheria.solutions/interview?i=docassemble.playground1IdahoRAForms%3Ashutoffandconditions.yml&reset=1";
        document.body.appendChild(iframe);
        document.querySelector("body > df-messenger").shadowRoot.querySelector("#widgetIcon").click();
    }
    if (event.detail.query == "Complete The Documents!") {
        // lease exit alternate apartment
        document.querySelectorAll('iframe').forEach(e => e.remove());
        var iframe = document.createElement('iframe');
        iframe.style.width = "100vw";
        iframe.style.height = "1200px";
        iframe.src = "https://docassemble.metatheria.solutions/interview?i=docassemble.playground1IdahoRAForms%3Aleaseexitalternateapt.yml&reset=1";
        document.body.appendChild(iframe);
        document.querySelector("body > df-messenger").shadowRoot.querySelector("#widgetIcon").click();
    }
    if (event.detail.query == "Ok, Let's Finish My Form!") {
        //caregiver 
        document.querySelectorAll('iframe').forEach(e => e.remove());
        var iframe = document.createElement('iframe');
        iframe.style.width = "100vw";
        iframe.style.height = "1200px";
        iframe.src = "https://docassemble.metatheria.solutions/interview?i=docassemble.playground1IdahoRAForms%3Acaregiver.yml&reset=1";
        document.body.appendChild(iframe);
        document.querySelector("body > df-messenger").shadowRoot.querySelector("#widgetIcon").click();
    }
    if (event.detail.query == "Ok, Let's Complete The Form!") {
        // communications
        document.querySelectorAll('iframe').forEach(e => e.remove());
        var iframe = document.createElement('iframe');
        iframe.style.width = "100vw";
        iframe.style.height = "1200px";
        iframe.src = "https://docassemble.metatheria.solutions/interview?i=docassemble.playground1IdahoRAForms%3Acommunication.yml&reset=1";
        document.body.appendChild(iframe);
        document.querySelector("body > df-messenger").shadowRoot.querySelector("#widgetIcon").click();
    }
    if (event.detail.query == "Ok, Let's Finish the Form!") {
        // application denials
        document.querySelectorAll('iframe').forEach(e => e.remove());
        var iframe = document.createElement('iframe');
        iframe.style.width = "100vw";
        iframe.style.height = "1200px";
        iframe.src = "https://docassemble.metatheria.solutions/interview?i=docassemble.playground1IdahoRAForms%3Aapplicationdenials.yml&reset=1";
        document.body.appendChild(iframe);
        document.querySelector("body > df-messenger").shadowRoot.querySelector("#widgetIcon").click();
    } 
    if (event.detail.query == "Ok, Finish My Form!") {
        // asthma
        document.querySelectorAll('iframe').forEach(e => e.remove());
        var iframe = document.createElement('iframe');
        iframe.style.width = "100vw";
        iframe.style.height = "1200px";
        iframe.src = "https://docassemble.metatheria.solutions/interview?i=docassemble.playground1IdahoRAForms%3Aasthma.yml&reset=1";
        document.body.appendChild(iframe);
        document.querySelector("body > df-messenger").shadowRoot.querySelector("#widgetIcon").click();
    }  
    if (event.detail.query == "Ok, Let's Complete My Form!") {
        // ramp modifications
        document.querySelectorAll('iframe').forEach(e => e.remove());
        var iframe = document.createElement('iframe');
        iframe.style.width = "100vw";
        iframe.style.height = "1200px";
        iframe.src = "https://docassemble.metatheria.solutions/interview?i=docassemble.playground1IdahoRAForms%3Arampmodifications.yml&reset=1";
        document.body.appendChild(iframe);
        document.querySelector("body > df-messenger").shadowRoot.querySelector("#widgetIcon").click();
    }
    if (event.detail.query == "Start Over") {
        document.querySelectorAll('iframe').forEach(e => e.remove());
    }
  });
  
  function isMobileDevice() {
    return (typeof window.orientation !== "undefined") || (navigator.userAgent.indexOf('IEMobile') !== -1);
  };

  window.addEventListener('dfMessengerLoaded', function(event) {
  if (isMobileDevice() === false) {
      const target = document.querySelector("body > df-messenger").shadowRoot.querySelector("div > df-messenger-chat").shadowRoot
      const newStyle = document.createElement('style')
      newStyle.innerHTML = 'div.chat-wrapper{width: 30vw !important;}';
      target.appendChild(newStyle);
    }
  });
</script>
</body>
</html>
